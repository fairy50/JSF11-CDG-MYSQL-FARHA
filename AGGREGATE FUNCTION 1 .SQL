USE CODEGNAN;

CREATE TABLE STUDENT_DATA
  (ID INT NOT NULL,
  STUNAME VARCHAR(100) NOT NULL,
  STUSUBJECT VARCHAR(10) NOT NULL,
  MARKS INT DEFAULT 0
  );
  
  DESC STUDENT_DATA;
  
  SELECT * FROM STUDENT_DATA;
  
  INSERT INTO STUDENT_DATA VALUES(1, "FARHA", "ENGLISH",90),(1, "FARHA", "MATHS",80),(1, "FARHA", "SOCIAL",70);
  INSERT INTO STUDENT_DATA VALUES(2, "FIRDOSE", "ENGLISH",99),(2, "FARHA", "MATHS",99),(2, "FARHA", "SOCIAL",99);
  INSERT INTO STUDENT_DATA VALUES(3, "HUSNA", "ENGLISH",99),(3, "HUSNA", "MATHS",9),(3, "HUSNA", "SOCIAL",9);
  INSERT INTO STUDENT_DATA VALUES(4, "ROSY", "ENGLISH",9),(4, "ROSY", "MATHS",100),(4, "ROSY", "SOCIAL",9);
  INSERT INTO STUDENT_DATA VALUES(5, "LILY", "ENGLISH",30),(5, "LILY", "MATHS",30),(5, "LILY", "SOCIAL",100);
  INSERT INTO STUDENT_DATA VALUES(6, "PAPPU", "ENGLISH",100),(6, "PAPPU", "MATHS",30),(6, "PAPPU", "SOCIAL",40);
  
SELECT count(MARKS) FROM STUDENT_DATA;
SELECT SUM(MARKS) FROM STUDENT_DATA;
SELECT max(MARKS) FROM STUDENT_DATA;
SELECT MIN(MARKS) FROM STUDENT_DATA;
SELECT AVG(MARKS) FROM STUDENT_DATA;

-- I NEED TOTAL MARKS RECORDS FOR EACH STUDENT 

SELECT ID,SUM(MARKS) AS TOTAL_MARKS FROM STUDENT_DATA GROUP BY ID;

SELECT ID,MARKS AS ENGLISH_MARKS FROM STUDENT_DATA WHERE STUSUBJECT="ENGLISH";

SELECT ID,STUNAME,SUM(MARKS) AS TOTAL_MARKS  FROM STUDENT_DATA GROUP BY ID,STUNAME HAVING TOTAL_MARKS>="150" ORDER BY TOTAL_MARKS DESC;

DROP TABLE LAST_MARKS;

CREATE TABLE LAST_MARKS(
   ID INT ,
   STUNAME VARCHAR(100),
   STUMARKS INT 
);
   
DESC LAST_MARKS;
SELECT * FROM LAST_MARKS;
INSERT INTO LAST_MARKS  SELECT ID,STUNAME,SUM(MARKS) AS TOTAL_MARKS FROM STUDENT_DATA GROUP BY ID,STUNAME;

