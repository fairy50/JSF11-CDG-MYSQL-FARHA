USE CODEGNAN;

DROP TABLE PRODUCTS_DATA;
CREATE TABLE products_DATA
( PRODUCT_ID INT NOT NULL,
  PRODUCT_NAME VARCHAR(100) NOT NULL,
  CATEGORY_NAME VARCHAR(50),
  PRICE INT NOT NULL
);

DESC PRODUCTS_DATA;

INSERT INTO PRODUCTS_DATA VALUES(101, "LEATHER ", "SNEAKERS",65.00),(101, "LEATHER ", "BOOTS",70.00),(101, "LEATHER", "SHOES",80.00);
INSERT INTO PRODUCTS_DATA VALUES(102, "JOGGING", "SNEAKERS",15.00),(102, "JOGGING ", "BOOTS",20.00),(102, "JOGGING", "SHOES",25.00);
INSERT INTO PRODUCTS_DATA VALUES(103, "HIGH PROFILE RUNNERS", "SNEAKERS",40.00),(103, "HIGH PROFILE RUNNERS ", "BOOTS",45.00),(103, "HIGH PROFILE RUNNERS", "SHOES",50.00);
INSERT INTO PRODUCTS_DATA VALUES(104,"SPORT WEAR", "SNEAKERS",100.00),(104, "SPORT WEAR ", "BOOTS",90.00),(104, "SPORT WEAR", "SHOES",95.00);
INSERT INTO PRODUCTS_DATA VALUES(105, "KNEE WEAR", "SNEAKERS",80.00),(105, "KNEE WEAR", "BOOTS",85.00),(105, "KNEE WEAR", "SHOES",75.00);
INSERT INTO PRODUCTS_DATA VALUES(106, "HIGH HEEL", "SNEAKERS",100.00),(106, "HIGH HEEL", "BOOTS",100.00),(106, "HIGH HEEL", "SHOES",50.00);

SELECT * FROM PRODUCTS_DATA;

-- COUNT 
SELECT count(CATEGORY_NAME) FROM PRODUCTS_DATA;

-- SUM
SELECT SUM(PRICE) FROM PRODUCTS_DATA;

-- AVG
SELECT AVG(PRICE) FROM PRODUCTS_DATA;

-- MIN
SELECT MIN(PRICE) FROM PRODUCTS_DATA;

-- MAX
SELECT MAX(PRICE) FROM PRODUCTS_DATA;


SELECT PRODUCT_ID,SUM(PRICE) FROM PRODUCTS_DATA GROUP BY PRODUCT_ID;
SELECT PRODUCT_ID,SUM(PRICE) AS TOTAL_PRICE FROM PRODUCTS_DATA GROUP BY PRODUCT_ID;

SELECT PRODUCT_ID,PRICE AS SNEAKERS_PRICE FROM PRODUCTS_DATA WHERE CATEGORY_NAME="SNEAKERS";

SELECT PRODUCT_ID,PRODUCT_NAME,SUM(PRICE) AS TOTAL_PRICE FROM PRODUCTS_DATA GROUP BY PRODUCT_ID,PRODUCT_NAME HAVING TOTAL_PRICE>=50 ORDER BY TOTAL_PRICE DESC;
SELECT PRODUCT_ID,PRODUCT_NAME,SUM(PRICE) AS TOTAL_PRICE FROM PRODUCTS_DATA GROUP BY PRODUCT_ID,PRODUCT_NAME HAVING TOTAL_PRICE>=50 ORDER BY TOTAL_PRICE ASC;


DROP TABLE TOTAL_PRICE;

CREATE TABLE LAST_PRICE
(PRODUCT_ID INT NOT NULL,
 PRODUCT_NAME VARCHAR(100) NOT NULL,
 PROPRICE INT NOT NULL
 );
 
 DESC LAST_PRICE;
INSERT INTO LAST_PRICE SELECT PRODUCT_ID,PRODUCT_NAME,SUM(PRICE) AS TOTAL_PRICE FROM PRODUCTS_DATA GROUP BY PRODUCT_ID,PRODUCT_NAME;
SELECT * FROM LAST_PRICE; 